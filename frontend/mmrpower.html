<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MMR Power Analysis</title>
    <link rel="stylesheet" href="styles/style.css">
</head>
<body>
    <h1>Estimation of Statistical Power for Detecting Moderating Effects of Categorical Variables Using Moderated Multiple Regression (MMR)</h1>
    <h2 class="sub-title">For more details, please see: <a href="https://www.hermanaguinis.com/pdf/ORM2001.pdf" class="book" target="_blank">Aguinis, H., Boik, R. J., & Pierce, C. A. 2001. A generalized solution for approximating the power to detect effects of categorical moderator variables using multiple regression. Organizational Research Methods, 4(4): 291-323. [pdf]</a></h2>
    <form id="powerAnalysisForm">
        <div class="form-group">
            <label for="subPopulations">Specify the number of moderator-based subgroups (k):</label>
            <input type="number" id="subPopulations" value="2" min="2" max="10" title="Min: 2, Max: 10">
        </div>
        <div class="form-group">
            <label for="errorRate">Specify your desired Type I Error Rate (α):</label>
            <input type="number" step="0.01" id="errorRate" value="0.05" min="0" max="1" title="Min: 0, Max: 1">
        </div>
        <div class="form-group select">
            <label for="scoreType">Specify whether you wish to conduct the power analysis based on inputting observable (i.e., as observed—including scores affected by measurement error) or true (i.e., assuming there is no measurement error) SDs and correlations:</label>
            <select id="scoreType" onchange="handleScoreTypeChange()">
                <option value="" selected disabled>Please select</option>
                <option value="observable">Observable</option>
                <option value="true">True</option>
            </select>
        </div>
        <h2 id="table-title">Enter your values in the table below:</h2>
        <table id="inputValues">
            <thead>
                <tr>
                    <th rowspan="2">Subgroup</th>
                    <th rowspan="2">Sample Sizes</th>
                    <th rowspan="2">XY Correlation</th>
                    <th colspan="2">Standard Deviation</th>
                    <th colspan="2">Reliability</th>
                    <th rowspan="2">Truncation Proportion</th>
                </tr>
                <tr>
                    <th>X</th>
                    <th>Y</th>
                    <th>X</th>
                    <th>Y</th>
                </tr>
            </thead>
            <tbody id="inputValuesBody">
                <tr>
                    <td class="non-editable">1</td>
                    <td class="editable" contenteditable="true" data-type="number" data-min="0" data-max="100"></td>
                    <td class="editable" contenteditable="true" data-type="number" data-min="0" data-max="1"></td>
                    <td class="editable with-decimals" contenteditable="true" data-type="decimal" data-min="0"></td>
                    <td class="editable with-decimals" contenteditable="true" data-type="decimal" data-min="0"></td>
                    <td class="editable with-decimals" contenteditable="true" data-type="number" data-min="0" data-max="1"></td>
                    <td class="editable with-decimals" contenteditable="true" data-type="number" data-min="0" data-max="1"></td>
                    <td class="editable with-decimals" contenteditable="true" data-type="number" data-min="0" data-max="1"></td>
                </tr>
                <tr>
                    <td class="non-editable">2</td>
                    <td class="editable" contenteditable="true" data-type="number" data-min="0" data-max="100"></td>
                    <td class="editable" contenteditable="true" data-type="number" data-min="0" data-max="1"></td>
                    <td class="editable with-decimals" contenteditable="true" data-type="decimal" data-min="0"></td>
                    <td class="editable with-decimals" contenteditable="true" data-type="decimal" data-min="0"></td>
                    <td class="editable with-decimals" contenteditable="true" data-type="number" data-min="0" data-max="1"></td>
                    <td class="editable with-decimals" contenteditable="true" data-type="number" data-min="0" data-max="1"></td>
                    <td class="editable with-decimals" contenteditable="true" data-type="number" data-min="0" data-max="1"></td>
                </tr>
            </tbody>
        </table>
        <div class="action-buttons">
            <button type="button" class="calculate-button" onclick="calculatePower()">Calculate Power</button>
            <button type="button" class="reset-button" onclick="resetForm()">Reset</button>
        </div>
        <h2 id="result-title">Power Analysis Results</h2>
        <div id="result"></div>
    </form>
    <script src="scripts/script.js"></script>
</body>
</html>
